{% extends 'memory_game/base.html' %}
{% load static %}
{% block title %}Juego{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'memory_game/css/juego.css' %}">
{% endblock %}

{% block content %}
<div class="py-4">

    <!-- Tarjeta de informaciÃ³n del juego -->
    <div class="card shadow-lg border-0 mb-4" style="max-width: 600px; margin: 0 auto;">
        <div class="card-header bg-primary text-white text-center">
            <h2 class="h5 mb-0">ğŸ¯ Nivel: {{ nivel|title }}</h2>
        </div>
        <div class="card-body d-flex justify-content-around text-center bg-light text-dark">
            <div>
                <h6>Intentos restantes</h6>
                <p class="fs-5 fw-bold"><span id="intentos">{{ intentos }}</span></p>
            </div>
            <div>
                <h6>â° Tiempo restante</h6>
                <p class="fs-5 fw-bold"><span id="tiempo">{{ tiempo }}</span> s</p>
            </div>
        </div>
    </div>

    <!-- Tablero de cartas -->
    <div class="card-container" id="tablero"></div>

    <!-- Botones de acciÃ³n dentro de tarjeta -->
    <div class="card shadow-lg border-0 mt-4" style="max-width: 500px; margin: 0 auto;">
        <div class="card-header bg-primary text-white text-center">
            <h5 class="mb-0">âš™ï¸ Opciones del juego</h5>
        </div>
        <div class="card-body text-center bg-light">
            <a href="{% url 'seleccion_nivel' %}" class="btn btn-warning nivel-btn-small mb-2">Cambiar nivel</a>
            <a href="{% url 'index' %}" class="btn btn-primary nivel-btn-small mb-2">Volver al inicio </a>
        </div>
    </div>

</div>

<!-- ğŸµ Audios -->
<audio id="audioMatch" src="{% static 'memory_game/audio/match.mp3' %}" preload="auto"></audio>
<audio id="audioMain" src="{% static 'memory_game/audio/main.mp3' %}" preload="auto" loop></audio>
<audio id="audioWin" src="{% static 'memory_game/audio/win.mp3' %}" preload="auto"></audio>
<audio id="audioLose" src="{% static 'memory_game/audio/lose.mp3' %}" preload="auto"></audio>

<!-- ğŸ† Modal de victoria -->
<div class="modal fade" id="modalWin" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered modal-sm">
        <div class="modal-content text-light text-center p-4" style="background: linear-gradient(135deg,#28a745,#218838);">
            <h3>ğŸ‰ Â¡Felicidades!</h3>
            <p>Completaste el juego correctamente.</p>
            <button class="btn btn-light mt-3" onclick="location.reload()">Volver a jugar</button>
        </div>
    </div>
</div>

<!-- ğŸ’€ Modal de derrota -->
<div class="modal fade" id="modalLose" tabindex="-1" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered modal-sm">
        <div class="modal-content text-light text-center p-4" style="background: linear-gradient(135deg,#dc3545,#a71d2a);">
            <h3>ğŸ˜¢ Has perdido</h3>
            <p>Se acabaron los intentos o el tiempo.</p>
            <button class="btn btn-light mt-3" onclick="location.reload()">Intentar de nuevo</button>
        </div>
    </div>
</div>

<!-- Bootstrap JS (para los modales) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

{% block extra_js %}
<script>
  const nivel = "{{ nivel|escapejs }}";
  const csrfToken = "{{ csrf_token }}";

</script>
<script src="{% static 'memory_game/js/juego.js' %}"></script>
{% endblock %}
{% endblock %}

